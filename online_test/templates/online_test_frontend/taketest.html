{% extends "online_test_frontend/index.html" %}
{% block content %}

	<div id="main" class="container">
		{% for test_sample in test %}
			<h1>{{test_sample.title}}</h1>
			<h4>{{test_sample.description}}</h4>
			<p>{{test_sample.instructions}}</p>
			<hr>
			{% for part in test_sample.part_exam %}
				<h3>{{part.name}}</h3>
				{% for section in part.section_part %}
					<h4>{{section.section_type}}</h4>
					<h4>Instructions:</h4> 
					<p>{{section.section_instructions}}</p>
					<div style="margin-left:50px;">
						{% for question in section.question_section %}
							{% if question %}
								<p>Q {{question.serial}} : {{question.content}}</p>

								<form method="post" action="" id="myform">
    							{% csrf_token %}

								{% for choices in question.question_choices_question %}
									{% for choice in choices.choices %}
										
										<input type="radio" onCLick="pass(this, this.value, this.name, this.class, this.id )" 
										class="{{test_sample.id}}" id= "{{student}}" name="{{question.serial}}" 
										value="{{choice}}" > {{ forloop.counter }} : {{choice}}<br>
									{% endfor %}
				    				
				    				<br>

								{% endfor %}

								</form>

							{% else %}
								<p>No Questions</p>
							{% endif %}

						{% endfor %}
					</div>
					<br>
				{% endfor %}
			{% endfor %}
			<center>
				<button><a href="{% url 'online_test_frontend:thankyou' student=student exam_id=test_sample.id %}">Submit</a>
				</button>
			</center>

		{% endfor %}
		
	</div>

<script type="text/javascript"> window.CSRF_TOKEN = "{{ csrf_token }}"; </script>
<script type="text/javascript">

function pass(obj, value, name, classobj, idobj) {

	var student_username=idobj;
	// e.preventDefault();
	var exam_id= $(obj).attr('class');

	
	var question_num= name;
	
	var array = new Array();
	array.push(value)
	var selected_choice= array;
	
	var objectJ={question_num,selected_choice};
	var myJ= JSON.stringify(objectJ);
	
	 $.ajax({

	 	type:'POST',
	 	url: "{% url 'online_test_frontend:submitselected' %}",
	 	data:{
	 		
	 		student:student_username,
	 		exam_id: exam_id,
	 		// selected: selected_choi,
	 		progress: myJ,
	 		csrfmiddlewaretoken: '{{ csrf_token }}'

	 		
	 	},

	 	success:function(){
	 		console.log('saved')

	 	}


	 })
	
}
</script>
{% endblock %}